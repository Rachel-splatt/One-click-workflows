"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[4259],{92980:(e,t,a)=>{var l=a(18225),i=a.n(l),n=a(36099),r=a(38646),u=a(95325),s=a(3067),o=a(20702),M=a(85387),c=a(12684),d=a(81298),g=a(55822);const m=["hour","day","week","month"];async function j(e){const t=await(0,d.Em)({method:"GET",accept:"json",url:g.edit_internal_workflow_path(e)});return t.ok?(0,c.wg)({success:!0,...await t.json()},[5,[0,"success",[8,!0]],[0,"workflow",[5,[0,"external_id",0],[0,"name",0],[0,"workflow_type",[9,[8,"product"],[8,"seller"],[8,"variant"],[8,"abandoned_cart"],[8,"audience"],[8,"affiliate"],[8,"follower"]]],[0,"workflow_trigger",[9,[8,null],[8,"member_cancellation"]]],[0,"published",2],[0,"first_published_at",[9,[8,null],0]],[0,"send_to_past_customers",2],[0,"installments",[6,[5,[0,"name",0],[0,"message",0],[0,"files",[6,[5,[0,"id",0],[0,"file_name",0],[0,"description",[9,[8,null],0]],[0,"extension",0],[0,"file_size",[9,[8,null],1]],[0,"is_pdf",2],[0,"pdf_stamp_enabled",2],[0,"is_streamable",2],[0,"stream_only",2],[0,"is_transcoding_in_progress",2],[0,"url",0],[0,"subtitle_files",[6,[5,[0,"url",0],[0,"file_name",0],[0,"extension",0],[0,"language",0],[0,"file_size",[9,[8,null],1]],[0,"signed_url",0]]]],[0,"thumbnail",[9,[8,null],[5,[0,"url",0],[0,"signed_id",0]]]]]]],[0,"published_once_already",2],[0,"member_cancellation",2],[0,"external_id",0],[0,"stream_only",2],[0,"call_to_action_text",[9,[8,null],0]],[0,"call_to_action_url",[9,[8,null],0]],[0,"new_customers_only",2],[0,"streamable",2],[0,"sent_count",[9,[8,null],1]],[0,"click_count",1],[0,"open_count",1],[0,"click_rate",[9,[8,null],1]],[0,"open_rate",[9,[8,null],1]],[0,"delayed_delivery_time_duration",1],[0,"delayed_delivery_time_period",[9,[8,"month"],[8,"hour"],[8,"week"],[8,"day"]]],[0,"displayed_delayed_delivery_time_period",0]]]],[0,"bought_products",[6,0],!0],[0,"not_bought_products",[6,0],!0],[0,"bought_variants",[6,0],!0],[0,"not_bought_variants",[6,0],!0],[0,"paid_more_than",0,!0],[0,"paid_less_than",0,!0],[0,"created_after",0,!0],[0,"created_before",0,!0],[0,"bought_from",0,!0],[0,"affiliate_products",[6,0],!0],[0,"unique_permalink",0,!0],[0,"variant_external_id",0,!0],[0,"abandoned_cart_products",[6,[5,[0,"unique_permalink",0],[0,"name",0],[0,"url",0],[0,"thumbnail_url",[9,[8,null],0]],[0,"variants",[6,[5,[0,"external_id",0],[0,"name",0]]]]]],!0],[0,"seller_has_products",2,!0]]],[0,"context",[5,[0,"products_and_variant_options",[6,[9,[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"product"]]],[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"variant"]]]]]],[0,"affiliate_product_options",[6,[12,3,2,1,2,1,1]]],[0,"timezone",0],[0,"currency_symbol",0],[0,"countries",[6,0]],[0,"aws_access_key_id",0],[0,"s3_url",0],[0,"user_id",0],[0,"gumroad_address",0]]]]):(0,c.wg)({success:!1,status:t.status},[5,[0,"success",[8,!1]],[0,"status",1]])}var L=a(59485),N=a(74443),I=a(31656),y=a(83332),_=a(39924),D=a(83343),w=a(22183),A=a(66681),E=a(53329),p=a(14990),S=a.n(p),z=a(98051),T=a(11924),b=a(30878),h=a(74328),x=a(29345),C=a(38546),f=a(32583),k=a(43599),v=a(51913),O=a(15707),Y=a(57751),U=a(1839),Q=a(88412);const P=e=>"abandoned_cart"===e.workflow_type?"abandoned_cart":"audience"===e.workflow_type?"legacy_audience":"follower"===e.workflow_type?"new_subscriber":"affiliate"===e.workflow_type?"new_affiliate":"member_cancellation"===e.workflow_trigger?"member_cancels":"purchase",Z=(e,t)=>e.filter((e=>t.includes(e.id)||!e.archived)),W=()=>{const e=(0,k.J)(),t=(0,u.useNavigate)(),{context:a,workflow:l}=(0,c.wg)((0,u.useLoaderData)(),[5,[0,"context",[5,[0,"products_and_variant_options",[6,[9,[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"product"]]],[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"variant"]]]]]],[0,"affiliate_product_options",[6,[12,1,2,1,2,1,1]]],[0,"timezone",0],[0,"currency_symbol",0],[0,"countries",[6,0]],[0,"aws_access_key_id",0],[0,"s3_url",0],[0,"user_id",0],[0,"gumroad_address",0]]],[0,"workflow",[5,[0,"external_id",0],[0,"name",0],[0,"workflow_type",[9,[8,"product"],[8,"seller"],[8,"variant"],[8,"abandoned_cart"],[8,"audience"],[8,"affiliate"],[8,"follower"]]],[0,"workflow_trigger",[9,[8,null],[8,"member_cancellation"]]],[0,"published",2],[0,"first_published_at",[9,[8,null],0]],[0,"send_to_past_customers",2],[0,"installments",[6,[5,[0,"name",0],[0,"message",0],[0,"files",[6,[5,[0,"id",0],[0,"file_name",0],[0,"description",[9,[8,null],0]],[0,"extension",0],[0,"file_size",[9,[8,null],1]],[0,"is_pdf",2],[0,"pdf_stamp_enabled",2],[0,"is_streamable",2],[0,"stream_only",2],[0,"is_transcoding_in_progress",2],[0,"url",0],[0,"subtitle_files",[6,[5,[0,"url",0],[0,"file_name",0],[0,"extension",0],[0,"language",0],[0,"file_size",[9,[8,null],1]],[0,"signed_url",0]]]],[0,"thumbnail",[9,[8,null],[5,[0,"url",0],[0,"signed_id",0]]]]]]],[0,"published_once_already",2],[0,"member_cancellation",2],[0,"external_id",0],[0,"stream_only",2],[0,"call_to_action_text",[9,[8,null],0]],[0,"call_to_action_url",[9,[8,null],0]],[0,"new_customers_only",2],[0,"streamable",2],[0,"sent_count",[9,[8,null],1]],[0,"click_count",1],[0,"open_count",1],[0,"click_rate",[9,[8,null],1]],[0,"open_rate",[9,[8,null],1]],[0,"delayed_delivery_time_duration",1],[0,"delayed_delivery_time_period",[9,[8,"month"],[8,"hour"],[8,"week"],[8,"day"]]],[0,"displayed_delayed_delivery_time_period",0]]]],[0,"bought_products",[6,0],!0],[0,"not_bought_products",[6,0],!0],[0,"bought_variants",[6,0],!0],[0,"not_bought_variants",[6,0],!0],[0,"paid_more_than",0,!0],[0,"paid_less_than",0,!0],[0,"created_after",0,!0],[0,"created_before",0,!0],[0,"bought_from",0,!0],[0,"affiliate_products",[6,0],!0],[0,"unique_permalink",0,!0],[0,"variant_external_id",0,!0],[0,"abandoned_cart_products",[6,[5,[0,"unique_permalink",0],[0,"name",0],[0,"url",0],[0,"thumbnail_url",[9,[8,null],0]],[0,"variants",[6,[5,[0,"external_id",0],[0,"name",0]]]]]],!0],[0,"seller_has_products",2,!0]],!0]]),i=(0,u.useRevalidator)(),n=!!(null==l?void 0:l.first_published_at),[o,M]=r.useState((()=>{var e,t,a,i,n,r;if(!l)return{name:"",trigger:"purchase",sendToPastCustomers:!1,affiliatedProducts:[],bought:[],notBought:[],paidMoreThan:null,paidLessThan:null,afterDate:"",beforeDate:"",fromCountry:""};const u="variant"===l.workflow_type&&l.variant_external_id?[l.variant_external_id]:"product"===l.workflow_type&&l.unique_permalink?[l.unique_permalink]:[...null!=(e=l.bought_products)?e:[],...null!=(t=l.bought_variants)?t:[]];return{name:l.name,trigger:P(l),sendToPastCustomers:l.send_to_past_customers,affiliatedProducts:null!=(a=l.affiliate_products)?a:[],bought:u,notBought:l.not_bought_products||l.not_bought_variants||[],paidMoreThan:l.paid_more_than?parseInt(l.paid_more_than.replaceAll(",",""),10):null,paidLessThan:l.paid_less_than?parseInt(l.paid_less_than.replaceAll(",",""),10):null,afterDate:null!=(i=l.created_after)?i:"",beforeDate:null!=(n=l.created_before)?n:"",fromCountry:null!=(r=l.bought_from)?r:""}})),[m,j]=r.useState(!1),[L,N]=r.useState((()=>new Set)),_=r.useRef(null),D=r.useRef(null),w=r.useRef(null),A="legacy_audience"!==o.trigger&&"new_affiliate"!==o.trigger,E="legacy_audience"===o.trigger||"purchase"===o.trigger||"new_subscriber"===o.trigger||"abandoned_cart"===o.trigger,p="abandoned_cart"!==o.trigger,z="purchase"===o.trigger||"member_cancels"===o.trigger,T="purchase"===o.trigger||"member_cancels"===o.trigger,h=e=>{const t=new Set(L);Object.keys(e).forEach((e=>{t.has(e)&&("paidMoreThan"===e||"paidLessThan"===e?(t.delete("paidMoreThan"),t.delete("paidLessThan")):"afterDate"===e||"beforeDate"===e?(t.delete("afterDate"),t.delete("beforeDate")):t.delete(e))})),M((t=>({...t,...e}))),N(t)},x=(0,b.B)((async(r="save")=>{var u,s,M,m;if(!(()=>{var e,t;const a=new Set,l=[];return""===o.name.trim()&&(a.add("name"),l.push(_)),n||(z&&o.paidMoreThan&&o.paidLessThan&&o.paidMoreThan>o.paidLessThan&&(a.add("paidMoreThan"),a.add("paidLessThan"),l.push(D)),p&&o.afterDate&&o.beforeDate&&new Date(o.afterDate)>new Date(o.beforeDate)&&(a.add("afterDate"),a.add("beforeDate"),l.push(w)),N(a),null==(t=null==(e=l[0])?void 0:e.current)||t.focus()),0===a.size})())return;const L=o.bought.flatMap((e=>{var t;return null!=(t=a.products_and_variant_options.find((({id:t})=>e===t)))?t:[]})),I=((e,t)=>{var a;return"abandoned_cart"===e?"abandoned_cart":"legacy_audience"===e?"audience":"new_subscriber"===e?"follower":"new_affiliate"===e?"affiliate":1===t.length?"variant"===(null==(a=t[0])?void 0:a.type)?"variant":"product":"seller"})(o.trigger,L),y="member_cancels"===o.trigger?"member_cancellation":null,S=("product"===I||"variant"===I)&&null!=(s=null==(u=L[0])?void 0:u.product_permalink)?s:null,b="variant"===I&&null!=(m=null==(M=L[0])?void 0:M.id)?m:null,h=A?L.reduce(((e,t)=>("variant"===t.type?e.variantIds.push(t.id):e.productIds.push(t.id),e)),{productIds:[],variantIds:[]}):{productIds:[],variantIds:[]},x=E?o.notBought.reduce(((e,t)=>{const l=a.products_and_variant_options.find((({id:e})=>t===e));return l&&("variant"===l.type?e.variantIds.push(l.id):e.productIds.push(l.id)),e}),{productIds:[],variantIds:[]}):{productIds:[],variantIds:[]},C={name:o.name,workflow_type:I,workflow_trigger:y,bought_products:h.productIds,bought_variants:h.variantIds,variant_external_id:b,permalink:S,not_bought_products:x.productIds,not_bought_variants:x.variantIds,paid_more_than:z?o.paidMoreThan:null,paid_less_than:z?o.paidLessThan:null,created_after:p?o.afterDate:"",created_before:p?o.beforeDate:"",bought_from:T?o.fromCountry:null,affiliate_products:"new_affiliate"===o.trigger?o.affiliatedProducts:[],send_to_past_customers:o.sendToPastCustomers,save_action_name:r};try{j(!0);const a=await(l?async function(e,t){const a=await(0,d.Em)({method:"PUT",accept:"json",url:g.internal_workflow_path(e),data:{workflow:t,link_id:t.permalink}});if(!a.ok)throw new d.o3;return(0,c.wg)(await a.json(),[9,[5,[0,"success",[8,!0]],[0,"workflow_id",0]],[5,[0,"success",[8,!1]],[0,"message",0]]])}(l.external_id,C):async function(e){const t=await(0,d.Em)({method:"POST",accept:"json",url:g.internal_workflows_path(),data:{workflow:e,link_id:e.permalink}});if(!t.ok)throw new d.o3;return(0,c.wg)(await t.json(),[9,[5,[0,"success",[8,!0]],[0,"workflow_id",0]],[5,[0,"success",[8,!1]],[0,"message",0]]])}(C));a.success?"save"===r?(e("Changes saved!","success"),t(`/workflows/${a.workflow_id}/emails`)):(e("save_and_publish"===r?"Workflow published!":"Unpublished!","success"),i.revalidate()):e(a.message,"error")}catch(t){(0,d.k4)(t),e("Sorry, something went wrong. Please try again.","error")}finally{j(!1)}}));return r.createElement(de,{title:l?l.name:"New workflow",navigation:l?r.createElement(je,{workflowExternalId:l.external_id}):null,actions:r.createElement(r.Fragment,null,r.createElement(s.Link,{to:"/workflows",className:"button outline",inert:m},r.createElement(y.I,{name:"x-square"}),"Cancel"),r.createElement(I.$,{color:"primary",onClick:()=>x(),disabled:m},l?"Save changes":"Save and continue"),l?r.createElement(ge,{isPublished:l.published,wasPublishedPreviously:n,isDisabled:m,sendToPastCustomers:"abandoned_cart"===o.trigger?null:{enabled:o.sendToPastCustomers,toggle:e=>h({sendToPastCustomers:e}),label:me(o.trigger)},onClick:x}):null)},r.createElement("form",null,r.createElement("section",null,r.createElement("header",null,"Workflows allow you to send scheduled emails to a subset of your audience based on a trigger."),r.createElement("fieldset",{className:S()({danger:L.has("name")})},r.createElement("legend",null,r.createElement("label",{htmlFor:"name"},"Name")),r.createElement("input",{id:"name",type:"text",ref:_,placeholder:"Name of workflow",maxLength:255,value:o.name,onChange:e=>h({name:e.target.value})})),r.createElement("fieldset",null,r.createElement("legend",null,r.createElement("label",{htmlFor:"trigger"},"Trigger")),r.createElement("div",{className:"radio-buttons",role:"radiogroup",style:{gridTemplateColumns:"repeat(auto-fit, minmax(11rem, 1fr))"}},l&&"audience"===l.workflow_type?r.createElement(I.$,{className:"vertical",role:"radio",disabled:n,"aria-checked":"legacy_audience"===o.trigger,onClick:()=>h({trigger:"legacy_audience"})},r.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzOCIgaGVpZ2h0PSIzNCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0ZGOTBFOCIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0zNi4xMjMgMTQuMjRhNC40NTkgNC40NTkgMCAwIDAtMS4wNDktMi4wMyA0LjM3NCA0LjM3NCAwIDAgMC0uMzQxLS44MiA0LjU2NCA0LjU2NCAwIDAgMC0xLjU5My0xLjY3NyA0LjU4NyA0LjU4NyAwIDAgMC0zLjIyNC0uNjE5bC0uMDk3LS4wMjVhNC43NzQgNC43NzQgMCAwIDAtLjc4LS4xMDYgMy45MTUgMy45MTUgMCAwIDAtLjc2Ni0xLjI2NWwtMi4xODQtMi40MjJhMy45NTcgMy45NTcgMCAwIDAtLjU5LS41MzUgMy45MjcgMy45MjcgMCAwIDAtMS4yMTYtMi41NkEzLjk1NiAzLjk1NiAwIDAgMCAyMS42NTYgMS4xTDE3LjczNCAxYTMuOTcgMy45NyAwIDAgMC0zLjEzNSAxLjQxMiAzLjkzNiAzLjkzNiAwIDAgMC0uODQgMy4zMjNsLjA1My4yNTlhMy42NSAzLjY1IDAgMCAwLS40NzEuMzM5TDEwLjc1OCA4LjUxYTMuOTQgMy45NCAwIDAgMC0uNTU1LjU3NCA0LjUxNiA0LjUxNiAwIDAgMC0yLjAyMyAwbC0uMDk4LjAyNWE0LjUzNCA0LjUzNCAwIDAgMC0zLjE3OC41NzQgNC41MDQgNC41MDQgMCAwIDAtMS45ODEgMi41NDEgNC40ODIgNC40ODIgMCAwIDAtMS4wNDkgMi4wMzJjLTEuMTcgMS41OTctMS4xNzQgMy45Mi4wNDMgNi40NC40MTYuODYgMS43NDcgMy4xOTUgMi44MDggNC42MS40NC41ODYgMS40MDMgMi4xMDYgMi4xNjMgMy4zNHYuOWMwIDEuMDQ2LjQxNyAyLjA0OCAxLjE1OSAyLjc4N2EzLjk2NCAzLjk2NCAwIDAgMCAyLjc5OCAxLjE1NWwxNi4zMDctLjAxN2MxLjA1IDAgMi4wNTYtLjQxNiAyLjc5OC0xLjE1NWEzLjkzNSAzLjkzNSAwIDAgMCAxLjE2LTIuNzg3di0uODk4Yy43Ni0xLjIyOSAxLjcyNi0yLjc1NCAyLjE2Mi0zLjM0IDEuMDYtMS40MDggMi4zOS0zLjc1IDIuODA4LTQuNjEgMS4yMjUtMi41MiAxLjIxNC00Ljg0Mi4wNDMtNi40NFoiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0iTTI0LjY4OCAxOC42NHMxLjkwOC0xLjM1MiAyLjk0Mi0zLjQwN2MxLjAzNC0yLjA1NSAxLjM1Ny0yLjc2IDEuOTg5LTIuNjE1IDEuMTY3LjI2NC4xMzggMi4yODQtLjIxMSAzLjA2My0uNDUyIDEuMDA1LTEuNjQ1IDIuNzc0LTEuNjQ1IDIuNzc0bTEuNzUtMi45MzNzMS4wNC0xLjk5IDEuMzU3LTIuNDU4Yy40MjQtLjYzNCAxLjA1Ni0uMzggMS4yMTktLjA3OC4xODYuMzQzLS4wMjYgMS4wNTUtLjM0NSAxLjgyMi0uMzE4Ljc2Ny0xLjY0NCAzLjU0LTIuMjU0IDQuMzg1Ii8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0zMS43NDEgMTQuODFzLjU1Ny0uNjg3IDEuMTQtLjI2NGMuNDcuMzQuMzQ2Ljc5MS0uMDI2IDEuODIyLS4zNzEgMS4wMzEtMS40NTggMy40MzQtMi4yIDQuMTIxbS0zLjkyNS0yLjQ5NXMyLjY5IDEuMDYyIDQuMjY4IDMuMDEiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0iTTMyLjc3NSAxNi41NTNzLjQyNC0uNjA4IDEuMDA4LS4xMzJjLjUwOC40MTQgMCAxLjk1NC0uMzQ1IDIuNjY4LS4zNDQuNzE0LTEuNjE4IDIuOTU4LTIuNTcyIDQuMjI3LS45NTQgMS4yNjgtMy4xNTYgNC45MTUtMy4xNTYgNC45MTV2Mi4xNGgtNy43MnMtLjA3Ni0zLjQwNC0uMDc2LTUuOTRjMC0yLjUzNyAxLjQzMi00LjU5NyAyLjQ2OC01Ljg2NCAxLjAzNS0xLjI2NyAxLjQ0LTIuMTcyIDEuODAyLTIuODI3LjQyNC0uNzY1IDEuNTM5LS4yNjQgMS4zOC42MDctLjE2Ljg3Mi0xLjUxMiAzLjY0NS0xLjUxMiAzLjY0NWE0Ljg4OCA0Ljg4OCAwIDAgMSAxLjM1NyAzLjE3MSIvPjxwYXRoIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNMjYuNTcxIDIwLjY3M3MxLjI3MiAxLjAwNCAxLjY0NCAyLjAwOG0tMTQuOTAzLTQuMDIzcy0xLjkxLTEuMzUyLTIuOTQ0LTMuNDA4Yy0xLjAzNS0yLjA1Ni0xLjM1Ny0yLjc1OC0xLjk5LTIuNjE1LTEuMTY1LjI2NC0uMTM2IDIuMjg2LjIxMyAzLjA2NS40NTIgMS4wMDMgMS42NDUgMi43NzMgMS42NDUgMi43NzNtLTEuNzUxLTIuOTM2cy0xLjAzOS0xLjk5LTEuMzU3LTIuNDU4Yy0uNDI0LS42MzUtMS4wNTYtLjM4My0xLjIyLS4wOC0uMTg1LjM0NC4wMjcgMS4wNTcuMzQ1IDEuODIyLjMxOS43NjYgMS42NDQgMy41NCAyLjI1NCA0LjM4NSIvPjxwYXRoIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNNi4yNTggMTQuODI3cy0uNTU4LS42ODYtMS4xNC0uMjY0Yy0uNDcxLjM0MS0uMzQ1Ljc5Mi4wMjYgMS44MjQuMzcxIDEuMDMgMS40NTggMy40MzMgMi4yMDEgNC4xMm0zLjkyOC0yLjQ5NXMtMi42OTEgMS4wNi00LjI3IDMuMDEiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0iTTUuMjI4IDE2LjU3MXMtLjQyNS0uNjA3LTEuMDA4LS4xMzNjLS41MDkuNDE1IDAgMS45NTYuMzQ0IDIuNjY5LjM0NC43MTIgMS42MTcgMi45NTkgMi41NzIgNC4yMjYuOTU1IDEuMjY3IDMuMTU2IDQuOTE2IDMuMTU2IDQuOTE2djIuMTRoNy43OTZ2LTUuOTQ2YzAtMi41MzYtMS40MzItNC41OTctMi40NjctNS44NjUtMS4wMzUtMS4yNjgtMS40NDEtMi4xNzEtMS44MDQtMi44MjctLjQyMy0uNzY2LTEuNTM3LS4yNjQtMS4zNzguNjA3LjE2Ljg3MiAxLjUxMSAzLjY0NiAxLjUxMSAzLjY0NmE0Ljg4MyA0Ljg4MyAwIDAgMC0xLjM1NyAzLjE3Ii8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0xMS40MjkgMjAuNjk4cy0xLjI3NCAxLjAwNC0xLjY0NSAyLjAwN20xMS40MTctOC43MjMgMi4yMjctNi43MSAyLjMzMyAyLjU4OHptLTIuMjI5LTIuOTYgMi43Ni02LjgxNS00LjE5Mi0uMTA1em0tMS40ODQgNS4wMTktMS44MDMtNy4yMzctMi43NTcgMi4zMjR6Ii8+PC9zdmc+",width:40,height:40}),r.createElement("div",null,r.createElement("h4",null,"Audience"),"A user becomes a customer, subscriber or an affiliate")):null,r.createElement(I.$,{className:"vertical",role:"radio",disabled:n,"aria-checked":"purchase"===o.trigger,onClick:()=>h({trigger:"purchase"})},r.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzOCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0ZGQzkwMCIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0zMC41NCAxMi4zNzhhNi43NiA2Ljc2IDAgMCAwLTEuNTU1LTIuNjg3IDYuNyA2LjcgMCAwIDAtMi41ODctMS43MDJjLTEuMzE0LS40ODQtMi43MzYtLjUzMi00LjA5MS0uMzQyYTE2LjUgMTYuNSAwIDAgMC0uNDY1LTIuMjggNS45NiA1Ljk2IDAgMCAwLTIuNjA0LTMuNDggNS45IDUuOSAwIDAgMC00LjI2NS0uNzc0IDUuOTMgNS45MyAwIDAgMC0zLjY1IDIuMzQ2IDYgNiAwIDAgMC0xLjA5IDQuMjE0bC4wNzYuNjg3Yy4wNjcuNjMzLjEzNSAxLjI4NS0xLjAxNCAzLjI0Ny0uNTk5Ljc3OC0zLjM5NSAyLjUxNy01LjkwNSAzLjY2OGE0LjEgNC4xIDAgMCAwLTIuMDA3IDEuOTk3IDQuMTIgNC4xMiAwIDAgMC0uMjM1IDIuODI4bDMuODQgMTMuODk4QTQuMSA0LjEgMCAwIDAgNi45MSAzNi40N2E0LjA2IDQuMDYgMCAwIDAgMy4wOTguMzgybDE0Ljk4Ni00LjE4YTcuMiA3LjIgMCAwIDAgNC0yLjg4NSA3LjI1IDcuMjUgMCAwIDAgMS4yMTMtNC43OTVxLjEwNC0uMjQuMTkyLS40NzhhNi4zMyA2LjMzIDAgMCAwIC4xMzMtMy43NzdxLjE5Mi0uNTIzLjI5LTEuMDczYTYuOSA2LjkgMCAwIDAtLjIxLTMuMzUyIDYuOSA2LjkgMCAwIDAtLjA3My0zLjkzM1oiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0ibTI1LjkyIDI0LjM5LjEzNy40OTNjLjIyLjc5Ni4xMTYgMS42NDYtLjI4OCAyLjM2NWEzLjEgMy4xIDAgMCAxLTEuODY4IDEuNDY3bC0xNC45ODYgNC4xOC0zLjg0LTEzLjg5N3M2LjI5Ni0yLjg3NiA3LjcwNS01LjI2OGMxLjQxLTIuMzkyIDEuNzgtMy45MzggMS41ODMtNS44MDRsLS4wODEtLjczNWExLjg3IDEuODcgMCAwIDEgLjMtMS4yNiAxLjg2IDEuODYgMCAwIDEgMS43NjctLjgxNiAxLjg1IDEuODUgMCAwIDEgMS4yMzcuN2MuMTUuMTkzLjI2Mi40MTQuMzI3LjY1LjI2NC45NTUuNDk1IDIuMTg4LjQxIDMuMzk3LS4xNzcgMi41MzEtMS43NDIgNi4wOS0xLjc0MiA2LjA5bDYuNTQ4LTEuNjY3LTEuMjItLjM4Ii8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0yMi44MzYgMjUuMzNzMy4xNzEtLjU4MiAzLjcwNi0yLjE1NGEyLjIzIDIuMjMgMCAwIDAtLjc5Mi0yLjU4Ii8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0yMi45ODggMjEuODQ3czMuNDM4LS43MyAzLjgxNy0yLjkwN2MuMzA4LTEuNzY4LS44MjUtMi40MTMtLjgyNS0yLjQxM20tMy40MDYgMS41MTNzMi42ODMtLjY2OSAzLjg4OS0yLjM2Yy42MzctLjkuMzk4LTMuMTU0LTEuNDYtMy44MzYtMS41OC0uNTgtNC4yMzkuMjIxLTUuNSAxLjEzNS0xLjI2MS45MTMtMS4wNzMgMi40Ni0xLjA3MyAyLjQ2TTE0LjQ4MSA4LjkzczEuNTQtLjIyNSAxLjUwOC0xLjQ2Yy0uMDQtMS41OTEtMS4xMy0xLjc4Ni0xLjEzLTEuNzg2Ii8+PC9zdmc+",width:40,height:40}),r.createElement("div",null,r.createElement("h4",null,"Purchase"),"A customer purchases your product")),r.createElement(I.$,{className:"vertical",role:"radio",disabled:n,"aria-checked":"new_subscriber"===o.trigger,onClick:()=>h({trigger:"new_subscriber"})},r.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNiIgaGVpZ2h0PSIzNiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzkwQThFRCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNNy42OCAzNS43NWEyLjggMi44IDAgMCAxLTEuNzA0LS41NzdMMi4xOSAzMi4yODJhMi44MiAyLjgyIDAgMCAxLTEuMDYtMS43MTdsLS44My00LjQ0YTIuODMgMi44MyAwIDAgMSAuOTItMi42NXYtLjAwMWwxLjk4NC0xLjcyNy4yMjgtLjE5OC0uMjM4LS4xODctLjIxLS4xNjVhMi44MiAyLjgyIDAgMCAxLS4zOTUtNC4wNCAyLjggMi44IDAgMCAxIDEuMjMxLS44MzhsMS41NTgtLjUzNC4yMjgtLjA3OS0uMDctLjIzYTIuODI1IDIuODI1IDAgMCAxIDEuMDIyLTMuMDg1Yy4zMS0uMjMuNjYzLS4zOTIgMS4wMzktLjQ4bDEuMzY2LS4zMTEuMjY4LS4wNjItLjA4Ni0uMjYtLjgtMi40MjZhMi44MjUgMi44MjUgMCAwIDEgMS4xMzgtMy4yNSAyLjggMi44IDAgMCAxIDEuMTQ1LS40MjhsLjE3LS4wMjQuMDM5LS4xNjdhNi4xMyA2LjEzIDAgMCAxIDIuMTUzLTMuNDA1QTYuMSA2LjEgMCAwIDEgMTYuNzg4LjI1aDEyLjIwM2E2LjEgNi4xIDAgMCAxIDQuMzE1IDEuNzk0IDYuMTMgNi4xMyAwIDAgMSAxLjc5IDQuMzIzVjE4LjU5YTYuMTMgNi4xMyAwIDAgMS0xLjc5IDQuMzIzIDYuMSA2LjEgMCAwIDEtNC4zMTUgMS43OTNoLS45ODZsLS4wNzIuMTI4YTIuODIgMi44MiAwIDAgMS0zLjQxIDEuMjZsLTEuNDY2LS41MzQtLjIzLS4wODQtLjA4OS4yMjgtLjI4LjcyMkEyLjgyIDIuODIgMCAwIDEgMjAuMTkgMjguMmgtLjI0MWwtLjA0OC4xOS0uODY5IDMuNTEzcS0uMDMuMTE5LS4wNjYuMjI3YTIuODIgMi44MiAwIDAgMS0xLjU4MyAxLjcgMi44IDIuOCAwIDAgMS0yLjMxOS0uMDY3bC0uMDEyLS4wMDYtMi43NDMtMS4xNjYtLjE1Mi0uMDY1LS4xMi4xMTUtMi4zOTggMi4zMTRhMi44IDIuOCAwIDAgMS0xLjk1OC43OTVaIi8+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTMyLjA0OCA2LjU5NHYxMi4yMjNhMy4zIDMuMyAwIDAgMS0yLjAzIDMuMDQ2Yy0uNC4xNjUtLjgyOC4yNS0xLjI2LjI1SDI0LjU5bC0uMDc5LjA0LTIuMDYtNC4yMTggNC41ODEtLjgwMS0zLjU1NC0yLjIyOCA1LjYyLTcuMjI1LTkuMTc0IDQuMjktMS4zNTktNC43NDItMi43MjkgMy45MjUtMi41ODYtMS41MTcuMDE2LS4wMjdWNi41OTRhMy4zIDMuMyAwIDAgMSAyLjAzLTMuMDQ2Yy40LS4xNjYuODI4LS4yNTEgMS4yNi0uMjUxaDEyLjIwM2EzLjI4IDMuMjggMCAwIDEgMy4wNCAyLjAzNWMuMTY1LjQuMjUuODI5LjI1IDEuMjYyIi8+PHBhdGggZmlsbD0iIzAwMCIgZD0ibTE4LjE2NCAxNC40NjQuODEyIDUuMjY3LS45NDYgMy44MTgtMS45NTkgNy45MTEtLjc4NS00LjQyNiAyLjg4LTEyLjUwM2gtLjAxNXoiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJtMTguMTY0IDE0LjUyOC0yLjg4IDEyLjUwNC0uMDI3LS4xNSAyLjg5MS0xMi4zNDh6bS03LjAwNiA5LjgyOC44MzMgNC40MzItNC41MzUgNC4zNjktLjgzNC00LjQzM3oiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0iTTEzLjI2NSA5LjYxVjYuNTk0YTMuMyAzLjMgMCAwIDEgMi4wMy0zLjA0NmMuNC0uMTY2LjgyOC0uMjUxIDEuMjYtLjI1MWgxMi4yMDNhMy4yODUgMy4yODUgMCAwIDEgMy4wNCAyLjAzNWMuMTY1LjQuMjUuODI5LjI1IDEuMjYydjEyLjIyM2EzLjMgMy4zIDAgMCAxLTIuMDMgMy4wNDZjLS40LjE2NS0uODI4LjI1LTEuMjYuMjVIMjQuNTkiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0ibTExLjM0MiAxNi44NzYtLjAwNi0uMDA0LTMuMzMzLTEuOTgyIDQuNjQ1LTEuMDc1LTEuODU3LTUuNjIzIDIuNDU4IDEuNDQ0IDIuNTg3IDEuNTE4IDIuNzI4LTMuOTI1IDEuMzYgNC43NDIgOS4xNzQtNC4yOS01LjYyMiA3LjIyNSAzLjU1NSAyLjIyNi00LjU4LjgwMiAyLjA2IDQuMjE4Ljc0IDEuNTE4LTQuMjc2LTEuNTU3LTEuMzY3IDMuNTE3LTEuNDM3LTIuMDQ2Ii8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Im0xOC4xNDggMTQuNTM0LTYuODEyIDIuMzM5LTYuODMgMi4zNDVzMS4zNjUgMS4wODQgMy4xMjQgMi40NDZsLTQuNzk2IDQuMTcgMy43ODIgMi44OW00LjU0Mi00LjM2OCA0LjEyMiAyLjY5OC4wMDQtLjAyMiIvPjxwYXRoIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJtNy40NTYgMzMuMTU3LS44MzQtNC40MzMgNC41MzYtNC4zNjkuODMzIDQuNDMzbTQuMDc5IDIuNjcyLjA0Mi4wMjYiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0ibTIuODM5IDI1LjgzMy44MzMgNC40MzMgMy43OSAyLjg5IDQuNTMtNC4zNjhzMy4xNCAyLjA3MyA0LjA3NiAyLjY3bTIuMDgtMTYuOTI1LjAxNi0uMDcuODEzIDUuMjY4LS45NDcgMy44MTgtMS45NTggNy45MTEtLjAwMS4wMDQtLjAwMS0uMDA2LS43ODctNC40MjYtLjAyNi0uMTV6Ii8+PC9zdmc+",width:40,height:40}),r.createElement("div",null,r.createElement("h4",null,"New subscriber"),"A user subscribes to your email list")),r.createElement(I.$,{className:"vertical",role:"radio",disabled:n,"aria-checked":"member_cancels"===o.trigger,onClick:()=>h({trigger:"member_cancels"})},r.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIzOCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0YxRjMzMyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0xOS41OSAxMi41MTdhNiA2IDAgMCAwLS44NjctLjQxNyA1LjggNS44IDAgMCAwLTEuMDM3LS44OWwuNjU2LTMuOTA2YTUuNSA1LjUgMCAwIDAtLjM4Ni0zLjEwNSA1LjM3IDUuMzcgMCAwIDAtMi4wMDgtMi4zNjYgNS4yIDUuMiAwIDAgMC0yLjk1Ny0uODMxIDUuMiA1LjIgMCAwIDAtMi45MTIuOTggNS4yMyA1LjIzIDAgMCAwLTUuNTktLjIyOCA1LjM3IDUuMzcgMCAwIDAtMi4wNDUgMi4xMTMgNS41IDUuNSAwIDAgMC0uNjQ4IDIuODkzbC41NTMgMTAuNzM2QTcuMjQgNy4yNCAwIDAgMCAxIDIxLjd2NC45MjJjMCAyLjgxMy45NiA0LjIgMi40MDQgNS40MjNxLjIwMy4xNi4zOC4zNWMuMDU1LjE2Ny4wODMuMzQyLjA4Mi41MTcgMCAuMDcxLS4wMDYuMTQyLS4wMDYuMjE1IDAgMS4wMjcuNCAyLjAxMiAxLjExMiAyLjczOEEzLjc2IDMuNzYgMCAwIDAgNy42NTYgMzdoMTEuMzM3YTMuNzYgMy43NiAwIDAgMCAyLjY4NS0xLjEzNSAzLjkgMy45IDAgMCAwIDEuMTExLTIuNzM5VjE4LjgzYzAtMy44NzUtMi4wMDUtNS42MTgtMy4xOTgtNi4zMTNaTTMuODcgMzIuODIzdi4wNzljLS4wMDQtLjA1IDAtLjA3OSAwLS4wNzlaIi8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0xNC4yMjggMjYuNjU0di0xLjYyYzAtLjQzOC0uMDg0LS44NzItLjI0OC0xLjI3N2EzLjQgMy40IDAgMCAwLS43MS0xLjA4MyAzLjMgMy4zIDAgMCAwLTEuMDYtLjcyNCAzLjIgMy4yIDAgMCAwLTEuMjUzLS4yNTRIOS4yNzRsMy4yMzItLjkwNGMuMzkyLS4xMS43My0uMzY3Ljk0NS0uNzE4YTEuNjkgMS42OSAwIDAgMC0uMDE4LTEuNzkgMS42MSAxLjYxIDAgMCAwLTEuNjg3LS43MTVsLTQuMzgxLjkxNGEzLjIgMy4yIDAgMCAwLTEuODQ1IDEuMTQgMy4zMiAzLjMyIDAgMCAwLS43MjQgMi4wNzR2NC45MjNjMCAyLjIyLjgxIDEuOTc4IDEuOTA2IDMuMjlzLjk1MyAzLjIwOC45NTMgMy4yMDgiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0iTTEzLjY3MyAxOC44ODhzLjAzMS0yLjE5NSAxLjMxOC0yLjk3NmMuOTU1LS41NzggNC4wMDEtLjkyMyA0LjAwMSAyLjkxN3YxNC4yOUg3LjY1NSIvPjxwYXRoIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNMTYuNDIgMTUuNTRzLS40My0xLjM3OC0xLjgxLTEuMzc4LTIuMzgzLjQzOC0yLjc2MyAxLjg5NmMtLjM4MSAxLjQ1Ny0uNDMgMS41NTUtLjQzIDEuNTU1Ii8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik02LjIyNiAxOC45NDQgNS41OTMgNi41NWMtLjAyLS40LjExLS43OTEuMzY2LTEuMDk0YTEuNSAxLjUgMCAwIDEgMi4xMTYtLjE4OGMuMzExLjI2LjUwOC42MzUuNTQ5IDEuMDQzbC45NDIgOS40NSAyLjExOS05LjcwM2ExLjUyIDEuNTIgMCAwIDEgLjYzMS0uOTM1IDEuNDcgMS40NyAwIDAgMSAxLjA5LS4yMjd2MGMuMzg2LjA3My43MjguMjk3Ljk1My42MjQuMjI0LjMyOC4zMTMuNzMzLjI0NyAxLjEyN2wtMS4yNzYgNy42MW0tNS41MzMgMS42MDUgNC4wNS4xOTVtMS42NjcgMy44OS0uMDEyLjExMmExLjY4IDEuNjggMCAwIDAgLjM2MiAxLjIyNyAxLjYgMS42IDAgMCAwIDEuMTE2LjU4OHYwYy4zOTYuMDMyLjc4OS0uMDg3IDEuMTA0LS4zMzNzLjUzLS42MDMuNjAzLTEuMDAxbC40OTQtMi42ODRtLjcxNSAxLjYwNC0xLjA0Ny4zODltLTYuMjQxLTEuOTM3YzAgLjE0NSAwIDEuMjYzIDEuMTkgMS4wMiAxLjE5MS0uMjQzIDEuNDc3LS45MjMgMS40NzctLjkyMyIvPjxwYXRoIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNMTMuODQ3IDIwLjk2NmMuMDQ4LS41MzQuMTQzLTEuNTA2IDEuMDQ4LTEuNDU3Ljk3LjA1MSAxLjM4MiAxLjAyIDEuMjg3IDEuOTQ0Ii8+PC9zdmc+",width:40,height:40}),r.createElement("div",null,r.createElement("h4",null,"Member cancels"),"A membership product subscriber cancels")),r.createElement(I.$,{className:"vertical",role:"radio",disabled:n,"aria-checked":"new_affiliate"===o.trigger,onClick:()=>h({trigger:"new_affiliate"})},r.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzNiIgaGVpZ2h0PSIyNiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzIzQTA5NCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNMjUuNjg4IDEuMDFjLjM2Mi4zNy42MDUuODQuNjk2IDEuMzV2LjMzNmwuMzMtLjExMiA0LjA1Mi0xLjM3NmEyLjUgMi41IDAgMCAxIDEuNTE1LS4wMzRjLjQ5Ny4xNDUuOTM4LjQzOSAxLjI2NS44NDNhMi41NzUgMi41NzUgMCAwIDEgLjIyNyAyLjkxMmwtLjAwMy4wMDYtLjAwNS4wMS0xLjQzNyAyLjUwMS0uMTc1LjMwNS4zNDYuMDY2IDEuMTczLjIyYy41MTguMDk3Ljk5My4zNTQgMS4zNi43MzZzLjYwOC44NjkuNjg4IDEuMzk1YTIuNiAyLjYgMCAwIDEtLjI0IDEuNTQgMi41NiAyLjU2IDAgMCAxLTEuMDc4IDEuMTE0bC0yLjA4MSAxLjExNi0uMjQzLjEzLjE1My4yMy42ODQgMS4wMmEyLjU4IDIuNTggMCAwIDEgLjAyIDIuODQzIDIuNTUgMi41NSAwIDAgMS0xLjEzLjk1MiAyLjUgMi41IDAgMCAxLTEuNDYzLjE2bC0uNC0uMDc0LS4zNTEtLjA2Ni4wNTcuMzUyLjI1OSAxLjU3OGMuMDg0LjUxNC4wMSAxLjA0MS0uMjEgMS41MTJhMi41NSAyLjU1IDAgMCAxLTEuMDI1IDEuMTIzIDIuNTI1IDIuNTI1IDAgMCAxLTIuODgtLjIzbC0yLjQwOC0xLjk4LS4xNzYtLjE0NS0uMTYuMTYyYTEwLjcgMTAuNyAwIDAgMS00LjUxIDIuNzE3aC0uMDAzYy0xLjQzNS40NTUtMi45My42OS00LjQzNC42OTYtMy4xMjYgMC02LjEzNy0xLjA2My04Ljg3Ny0zLjE3MUExOS42IDE5LjYgMCAwIDEgLjYzIDE2LjY2M2EyLjU4IDIuNTggMCAwIDEgLjQ3LTMuMjZsLjAwNC0uMDA0LjA4NS0uMDhjMS43Ni0xLjYxOCAyLjYxNC0yLjg1MyAzLjAyMi0zLjYwNSAxLjg0Ni0zLjM5OCA0LjUyMi00LjI1MiA2LjQ0LTQuMzc3YTcuNyA3LjcgMCAwIDEgMS45NTcuMTI4bC4xMzMuMDI2LjA5NS0uMDk4Yy42MTgtLjYzNyAxLjQxNi0xLjI2NyAyLjM3My0xLjYyNyAxLjU0NS0uNTgzIDMuMy0uNTk3IDQuOTg1LS4wNzJsLjE5LjA1OS4xLS4xNzIgMS4yMDUtMi4wNjVBMi41NSAyLjU1IDAgMCAxIDIyLjgyMi40ODNhMi41MiAyLjUyIDAgMCAxIDIuODY2LjUyN1oiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMjMuNzE0IDguMjM1cS4wMDIuMDAxLS4wMDcuMDgyYy0uMDUuNTgtLjQ1NCA0LjA4My0yLjc5NyA2LjcwNmwtLjEzMi0uMTk4Yy0xLjM1LS42OTQtMy43NDEtLjA0LTQuNTk5IDEuMDg2LTQuNjUyLS4zMy02LjU5IDIuMjA3LTYuNTkgMi4yMDdsLS4wMTIuMDk1Yy00LjI0OC0uNjAxLTYuNzIyLTIuNzk3LTYuODA4LTIuODc2LjExLS4wMjYgMy43NjMtLjkwNyA1LjA5LTEuNDE4IDEuMTA4LS40MjcgMS43ODMtMS4wOCAyLjYxNS0xLjU0NWwuMDg3LjAzYy4xMjMuMDQ0IDEuNDU0IDIuMDk3IDIuNDgzIDIuMjQyLjU3NC4wNzcgMS42NTgtLjE4OCAyLjYwOC0uNTA4Ljc1NC0uMjUzIDEuNDI0LS41NCAxLjY5OC0uNzE2Ljc0OS0uNDg4LjIxOS0zLjU3LjIxOS0zLjU3bC0uMDIyLS4wNTRjLjU4Mi0uMjUgMS4yNTgtLjM5NCAyLjE3Mi0uNDEzIDEuNzk0LS4wNCAzLjk5NS0xLjE1IDMuOTk1LTEuMTUiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0iTTIuNzY5IDE1LjMzNWMuMjAxLS4xOTcgMi40NDYtMi4xNSAzLjY1LTQuMzY5czIuODI2LTIuOTQ4IDQuMzc0LTMuMDVhNS44IDUuOCAwIDAgMSAyLjgzNy42MDRzMS4wMTUtMS43OTIgMi40NDUtMi4zMzIgMy4zNDQtLjMyMyA1IC43NnEuMTQyLjA5Ny4yOC4xOGMxLjQ4NC45MjcgMi4zNiAxLjEwNCAyLjM2IDEuMTA0cy0yLjIwMyAxLjEwMy0zLjk5NyAxLjE0NGMtLjkxNC4wMi0xLjU5LjE2NC0yLjE3Mi40MTMtLjU2MS4yNC0xLjAzNy41NzUtMS41Ni45ODUtLjUyMi40MS0uODA2LjY1NC0xLjIxOS44MDQtLjQzOC4xNi0xLjAyNC4yMS0yLjE3Ny4yMmE0LjI0IDQuMjQgMCAwIDAtMi4xMTYuNTYyYy0uODMyLjQ2OC0xLjUwNyAxLjEyMS0yLjYxNSAxLjU0NS0xLjMyNy41MS00Ljk3NSAxLjM5Mi01LjA5IDEuNDE4Ii8+PHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0yLjc2OSAxNS4zMzVjLjA4OC4xNTUgNS41MDUgOS40MDEgMTQuOTkxIDYuNDU2IDIuNDM4LS43NTggMy45NTQtMi4yOCA0Ljg4MS00LjAzNiAyLjE1NC00LjA4MyAxLjEzNC05LjQ0IDEuMTM0LTkuNDQiLz48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIuNSIgZD0iTTIzLjcxNCA4LjIzNXEuMDAyLjAwMS0uMDA3LjA4MmMtLjA1LjU4LS40NTQgNC4wODMtMi43OTcgNi43MDZhOC41IDguNSAwIDAgMS0zLjc4NiAyLjQ2Yy0yLjkwMi45MzYtNS40NDIgMS4wMy03LjU0Ny43MzEtNC4yNDgtLjYwMS02LjcyMi0yLjc5Ny02LjgwOC0yLjg3NSIvPjxwYXRoIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNMTAuNTYyIDEyLjM5OWMuMTIzLjA0NCAxLjQ1NSAyLjA5NyAyLjQ4MyAyLjI0MS41NzQuMDc3IDEuNjU4LS4xODcgMi42MDgtLjUwNy43NTQtLjI1MyAxLjQyNC0uNTQgMS42OTgtLjcxNi43NDktLjQ4OC4yMTktMy41Ny4yMTktMy41N20xMy45ODQtNi4xODlMMjguMTI2IDkuNjNsNS4wNTguOTUtNC44MjIgMi41ODUgMi40MjEgMy42MS00LjMxOC0uODEzLjkwNyA1LjU0LTQuNDgtMy42ODNtLTEuNTMyLTEwLjcgMi40OTctNC4yODRzLjY0NCAzLjc5Ljc2NiAzLjc5M2MuMTIzLjAwMiA2LjgyNS0yLjkyNiA2LjkyOS0yLjk3TTE0LjggMTEuNjdsLjgzNCAyLjM2OE05LjU5IDE4LjExOXMxLjkzNy0yLjUzOCA2LjU4OS0yLjIwN2MuODU4LTEuMTI2IDMuMjUtMS43OCA0LjYtMS4wODYiLz48L3N2Zz4=",width:40,height:40}),r.createElement("div",null,r.createElement("h4",null,"New affiliate"),"A user becomes an affiliate of yours")),r.createElement(I.$,{className:"vertical",role:"radio",disabled:n,"aria-checked":"abandoned_cart"===o.trigger,onClick:()=>h({trigger:"abandoned_cart"})},r.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0RDMzQxRSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik0xMi43MzcgMzAuMDk0YS42LjYgMCAwIDEgLjI4LS4yOTEuODEuODEgMCAwIDEgLjg1NC4wOGMuMTEuMDkxLjE3Ni4yMS4xOS4zMzUuMDU5LjUzNC4xODcgMS4wMTIuNDIgMS4zNiAxLjY0NSAyLjQ2IDUuMDUgMy4zODcgNy42MjUgMy43M2w4LjA4IDEuMTI1cS4zOTEuMDU0Ljc4OC4wNTVjLjczOCAwIDEuNDY2LS4xNDIgMi4xMjItLjQxNWE0LjUgNC41IDAgMCAwIDEuNjUyLTEuMTUyYy40My0uNDg1LjcxLTEuMDQ1LjgxOC0xLjYzNWEzLjA3IDMuMDcgMCAwIDAtLjItMS43NTVsLTEuNjE2LTMuODI2IDIuOTgxLTIuNjM2Yy40NzQtLjQxLjgzLS45IDEuMDQyLTEuNDM1LjIxMy0uNTM0LjI3Ny0xLjEuMTg4LTEuNjU2LS4xMy0uNzYtLjU0NS0xLjQ3LTEuMTktMi4wMzMtLjY0Ni0uNTYzLTEuNDktLjk1My0yLjQyLTEuMTE2bC0yLjY2Ni0uNDdhNS41IDUuNSAwIDAgMCAuMzQtMi43MTQgNS45IDUuOSAwIDAgMC0xLjAyLTIuNjAyIDcuNCA3LjQgMCAwIDAtMi4yMTItMi4wNjIgOS4zIDkuMyAwIDAgMC0zLjA0My0xLjE4NmwtMi4yOS0uNDY1YTQuOSA0LjkgMCAwIDAtLjg2OS0yLjQyYy0uNTExLS43NDUtMS4yMjQtMS4zODYtMi4wODUtMS44NzZhOCA4IDAgMCAwLTIuODg4LS45NTggOC42IDguNiAwIDAgMC0zLjExNi4xNTIgNy42IDcuNiAwIDAgMC0yLjcyNSAxLjIzYy0uNzgyLjU3LTEuMzk0IDEuMjc2LTEuNzkyIDIuMDY1YTQuNyA0LjcgMCAwIDAtLjUwMiAyLjQ4N2MuMDY3Ljg1LjM3IDEuNjc1Ljg4OCAyLjQxN2wtOC4xIDE4LjI4MmEzLjA3IDMuMDcgMCAwIDAtLjIyOSAxLjc2N2MuMS41OTYuMzc2IDEuMTYzLjgwNSAxLjY1NC40MjguNDkxLjk5Ny44OTIgMS42NTcgMS4xNjkuNjYuMjc2IDEuMzk0LjQyIDIuMTM4LjQyIDEuOTA1IDAgNC4xMzMtLjk1NSA0LjgxMi0yLjQ4NnoiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMjEuMDA2IDIxLjc0OGMxLjk1OS4zOTcgMy4yOTYgMi4wMiAyLjc1NyAzLjU0MWwtLjEyNy4yOTRjLTEuMDM2IDEuOTgzLTMuNjE0LjU0Ni00LjgzNCAxLjk3LjY2Ni0xLjI5MyAyLjIwNC01LjgwNSAyLjIwNC01LjgwNSIvPjxwYXRoIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNMTUuOTk3IDExLjUxMXEuMjM1LjAzOS40NzQuMDRjLjU5My0uMDAxIDEuMTY0LS4xODEgMS42LS41MDYuNDM0LS4zMjUuNzAyLS43Ny43NS0xLjI0Ny4wNDctLjQ3Ni0uMTMtLjk1LS40OTUtMS4zMjctLjM2Ni0uMzc2LS44OTQtLjYyNy0xLjQ3OS0uNzA0YTIuOCAyLjggMCAwIDAtMS42NzguMjkyYy0uNDk0LjI2NC0uODQ3LjY2OS0uOTg4IDEuMTMzLS4xNDIuNDY1LS4wNjEuOTU1LjIyNSAxLjM3NHMuNzU4LjczNiAxLjMyLjg4N3EuMTMzLjAzNi4yNy4wNThtLS4xMzYuMTM0LjA4OC4wMTcgOC42NjUgMS43NjFjLjQ5NC4xLjk1Ny4yODEgMS4zNjEuNTMyLjQwNC4yNS43NC41NjUuOTg2LjkyNS4yNDcuMzYuNC43NTcuNDQ4IDEuMTY2YTIuNDYgMi40NiAwIDAgMS0uMTY1IDEuMjE0bC0xLjY3IDMuODQ4LTEuODEgNC4xNzctLjEyNy4yOTRNNi42NDIgMzEuOTcxbDUuMzQ5LTEyLjA3NyAzLjY5My04LjM0NG0yLjg4NCAxNi4zNDJhLjkuOSAwIDAgMCAuMjMzLS4zMzhjLjY2Ny0xLjI5NCAyLjIwNS01LjgwNiAyLjIwNS01LjgwNiIvPjxwYXRoIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9Ii41IiBkPSJtMjUuNjE1IDIxLjEyIDcuNzU1IDEuMzY0LTQuODk0IDQuMzI3IDIuNTA1IDUuOTI0LTguMDk3LTEuMTI0Yy0zLjkwMS0uNTE3LTUuMjQxLTIuMDIyLTQuMzEtMy43MTVxLjA5Ny0uMTc4LjIzNC0uMzM4YzEuMjItMS40MjYgMy43OTguMDEyIDQuODM0LTEuOTcxcS4wNzYtLjE0NC4xMjctLjI5NGMuNTM5LTEuNTItLjc5OC0zLjE0NC0yLjc1Ny0zLjU0MWwtOC43NTgtMS43OCIvPjwvc3ZnPg==",width:40,height:40}),r.createElement("div",null,r.createElement("h4",null,"Abandoned cart"),"A customer doesn't complete checking out"))),n||"abandoned_cart"===o.trigger?null:r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:o.sendToPastCustomers,onChange:e=>h({sendToPastCustomers:e.target.checked})}),me(o.trigger))),"new_affiliate"===o.trigger?r.createElement("fieldset",null,r.createElement("legend",null,r.createElement("label",{htmlFor:"affiliated_products"},"Affiliated products")),r.createElement(Q.F,{inputId:"affiliated_products",placeholder:"Select products...",isDisabled:n,tagIds:o.affiliatedProducts,tagList:Z(a.affiliate_product_options,o.affiliatedProducts),onChangeTagIds:e=>h({affiliatedProducts:e})}),n?null:r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:o.affiliatedProducts.length===Z(a.affiliate_product_options,o.affiliatedProducts).length,onChange:e=>h({affiliatedProducts:e.target.checked?Z(a.affiliate_product_options,o.affiliatedProducts).map((({id:e})=>e)):[]})}),"All products")):null,A?r.createElement("fieldset",null,r.createElement("legend",null,r.createElement("label",{htmlFor:"bought"},"member_cancels"===o.trigger?"Is a member of":"abandoned_cart"===o.trigger?"Has products in abandoned cart":"Has bought")),r.createElement(Q.F,{inputId:"bought",placeholder:"Any product",isDisabled:n,tagIds:o.bought,tagList:Z(a.products_and_variant_options,o.bought),onChangeTagIds:e=>h({bought:e})}),"abandoned_cart"===o.trigger?r.createElement("small",null,"Leave this field blank to include all products"):null):null,E?r.createElement("fieldset",null,r.createElement("legend",null,r.createElement("label",{htmlFor:"not_bought"},"abandoned_cart"===o.trigger?"Does not have products in abandoned cart":"Has not yet bought")),r.createElement(Q.F,{inputId:"not_bought",placeholder:"No products",isDisabled:n,tagIds:o.notBought,tagList:Z(a.products_and_variant_options,o.notBought),onChangeTagIds:e=>h({notBought:e}),maxTags:1})):null,z?r.createElement("div",{style:{display:"grid",gap:"var(--spacer-3)",gridTemplateColumns:"repeat(auto-fit, max(var(--dynamic-grid), 50% - var(--spacer-3) / 2))"}},r.createElement("fieldset",{className:S()({danger:L.has("paidMoreThan")})},r.createElement("legend",null,r.createElement("label",{htmlFor:"paid_more_than"},"Paid more than")),r.createElement(O.Q,{onChange:e=>h({paidMoreThan:e}),value:o.paidMoreThan},(e=>r.createElement("div",{className:S()("input",{disabled:n})},r.createElement("div",{className:"pill"},a.currency_symbol),r.createElement("input",{id:"paid_more_than",type:"text",disabled:n,ref:D,autoComplete:"off",placeholder:"0",...e}))))),r.createElement("fieldset",{className:S()({danger:L.has("paidLessThan")})},r.createElement("legend",null,r.createElement("label",{htmlFor:"paid_less_than"},"Paid less than")),r.createElement(O.Q,{onChange:e=>h({paidLessThan:e}),value:o.paidLessThan},(e=>r.createElement("div",{className:S()("input",{disabled:n})},r.createElement("div",{className:"pill"},a.currency_symbol),r.createElement("input",{id:"paid_less_than",type:"text",disabled:n,autoComplete:"off",placeholder:"âˆž",...e})))))):null,p?r.createElement("div",{style:{display:"grid",gap:"var(--spacer-3)",gridTemplateColumns:"repeat(auto-fit, max(var(--dynamic-grid), 50% - var(--spacer-3) / 2))"}},r.createElement("fieldset",{className:S()({danger:L.has("afterDate")})},r.createElement("legend",null,r.createElement("label",{htmlFor:"after_date"},"new_subscriber"===o.trigger?"Subscribed after":"member_cancels"===o.trigger?"Canceled after":"new_affiliate"===o.trigger?"Affiliate after":"Purchased after")),r.createElement("input",{type:"date",id:"after_date",disabled:n,ref:w,value:o.afterDate,onChange:e=>h({afterDate:e.target.value})}),r.createElement("small",null,"00:00 ",a.timezone)),r.createElement("fieldset",{className:S()({danger:L.has("beforeDate")})},r.createElement("legend",null,r.createElement("label",{htmlFor:"before_date"},"new_subscriber"===o.trigger?"Subscribed before":"member_cancels"===o.trigger?"Canceled before":"new_affiliate"===o.trigger?"Affiliate before":"Purchased before")),r.createElement("input",{type:"date",id:"before_date",disabled:n,value:o.beforeDate,onChange:e=>h({beforeDate:e.target.value})}),r.createElement("small",null,"11:59 ",a.timezone))):null,T?r.createElement("fieldset",null,r.createElement("legend",null,r.createElement("label",{htmlFor:"from_country"},"From")),r.createElement("select",{id:"from_country",disabled:n,value:o.fromCountry,onChange:e=>h({fromCountry:e.target.value})},r.createElement("option",{value:""},"Anywhere"),a.countries.map((e=>r.createElement("option",{key:e,value:e},e))))):null)))};var H=a(29816),R=a(61863),J=a(74491),G=a(55822),B=a(95244).A;const V=r.createContext(null),F=V.Provider,X=({email:e,workflowTrigger:t,expanded:a,focusedFieldInfo:l,invalidFieldNames:i,toggleExpanded:n,onChange:u,onFocus:s,onDelete:o,onSendPreviewEmail:M,isSaving:d,hasUploadingImages:g})=>{const[j,L]=r.useState(e.message),N=(0,R.Y)((e=>u({message:e})),500),_=r.useRef(null),D=r.useRef(null),w=(0,C.Pq)((t=>t.filter((({email_id:t})=>t===e.id))));r.useEffect((()=>{var t,a;if((null==l?void 0:l.emailId)!==e.id)return;const{fieldName:i}=l;"name"===i&&(null==(t=D.current)||t.focus()),"message"!==i&&"stream_only"!==i&&(null==(a=_.current)||a.scrollIntoView({behavior:"smooth"}))}),[l]),r.useEffect((()=>{a&&L(e.message)}),[a]);const A="abandoned_cart"===t,E=d||w.some((e=>(0,C._h)(e)||e.subtitle_files.some((e=>(0,C._h)(e)))));return r.createElement("div",{ref:_,"aria-label":"Email"},r.createElement("div",{className:"content"},r.createElement(y.I,{name:"envelope-fill",className:"type-icon"}),r.createElement("h3",null,""===e.name.trim()?"Untitled":e.name)),r.createElement("div",{className:"actions"},A?null:r.createElement(I.$,{outline:!0,disabled:a&&g||!1,"aria-label":"Edit",onClick:n},r.createElement(y.I,{name:a?"outline-cheveron-up":"outline-cheveron-down"})),r.createElement(J.k,{tip:"Send email preview"},r.createElement(I.$,{outline:!0,"aria-label":"Preview Email",disabled:E,onClick:M},r.createElement(y.I,{name:"eye-fill"}))),A?null:r.createElement(J.k,{tip:"Delete"},r.createElement(I.$,{outline:!0,color:"danger","aria-label":"Delete",disabled:E,onClick:o},r.createElement(y.I,{name:"trash2"})))),a?r.createElement("form",{className:"paragraphs"},A?null:r.createElement("div",{style:{display:"grid",gap:"var(--spacer-3)",gridTemplateColumns:"repeat(auto-fit, minmax(var(--dynamic-grid), 1fr))"}},r.createElement(O.Q,{onChange:e=>u({delayed_delivery_time_duration:null!=e?e:0}),value:e.delayed_delivery_time_duration},(e=>r.createElement("input",{type:"text",autoComplete:"off",placeholder:"0","aria-label":"Duration",onFocus:()=>s("delayed_delivery_time_duration"),...e}))),r.createElement("select",{value:e.delayed_delivery_time_period,"aria-label":"Period",onChange:e=>u({delayed_delivery_time_period:(0,c.wg)(e.target.value,[9,[8,"month"],[8,"hour"],[8,"week"],[8,"day"]])}),onFocus:()=>s("delayed_delivery_time_period")},m.map((a=>r.createElement("option",{key:a,value:a},B.t(`js.workflows_emails_time_period_labels.${t}.${a}`,{count:e.delayed_delivery_time_duration})))))),r.createElement("fieldset",{className:S()({danger:i.includes("name")})},r.createElement("input",{ref:D,type:"text",placeholder:"Subject",value:e.name,maxLength:255,onChange:e=>u({name:e.target.value}),onFocus:()=>s("name")})),r.createElement(Y.dS,{id:e.id,className:"textarea",ariaLabel:"Email message",placeholder:"Write a personalized message...",extensions:[...A?[ee]:[]],initialValue:j,onChange:N,onCreate:e=>e.on("focus",(()=>s("message")))}),A?null:r.createElement(C.JX,{emailId:e.id,isStreamOnly:e.stream_only,setIsStreamOnly:e=>u({stream_only:e})})):null)},$=({email:e,isEditing:t,workflowTrigger:a,gumroadAddress:l})=>{const[i,n]=r.useState(!1);r.useEffect((()=>n(!0)),[]);const u=(0,Y.Wk)({ariaLabel:"Email message",initialValue:i?e.message:null,editable:!1,extensions:[..."abandoned_cart"===a?[ee]:[]]}),s=r.useRef(null),o=(0,C.Pq)((t=>t.filter((({email_id:t})=>t===e.id))));return r.useEffect((()=>{t&&setTimeout((()=>{var e;return null==(e=s.current)?void 0:e.scrollIntoView({behavior:"smooth"})}),500)})),r.createElement("section",{className:"paragraphs",ref:s},r.createElement("div",{role:"separator"},r.createElement("div",{style:{display:"flex",gap:"var(--spacer-2)"}},r.createElement(y.I,{name:"outline-clock"}),e.delayed_delivery_time_duration," ",B.t(`js.workflows_emails_time_period_labels.${a}.${e.delayed_delivery_time_period}`,{count:e.delayed_delivery_time_duration}))),r.createElement("div",{className:"card"},r.createElement("div",{className:"paragraphs"},r.createElement("h3",null,""===e.name.trim()?"Untitled":e.name),r.createElement(E.$Z,{className:"rich-text",editor:u}),o.length>0?r.createElement(I.$,{color:"primary"},"View content"):null,r.createElement("hr",null),r.createElement("div",{className:"paragraphs",style:{justifyItems:"center"}},r.createElement("p",null,l),r.createElement("p",null,"Powered by ",r.createElement("span",{style:{marginLeft:"var(--spacer-1)"},className:"logo-full"}))))))},q=e=>{const t=(0,x.z8)(),{abandonedCartProducts:a,shownProductCount:l,setShownProductCount:i,showAddProductCTA:n}=(0,L.i)(r.useContext(V)),u=r.useId(),s=!e.editor.isEditable;return r.createElement(E.VR,{className:"paragraphs",style:s?{}:{userSelect:"none",cursor:"not-allowed"}},r.createElement("div",{className:"has-tooltip top","aria-describedby":u,style:{display:"grid"}},a.length>0?r.createElement("div",{className:"cart",role:"list"},a.slice(0,l).map((e=>r.createElement("div",{role:"listitem",key:e.unique_permalink,style:s?{}:{pointerEvents:"none"}},r.createElement("section",null,r.createElement("figure",{style:{margin:0}},e.thumbnail_url?r.createElement("img",{src:e.thumbnail_url,style:{objectFit:"initial",borderRadius:0}}):null),r.createElement("section",null,r.createElement("h4",null,r.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer nofollow",tabIndex:s?void 0:-1},e.name)),r.createElement("footer",null,r.createElement(K,{isPreview:s}))),r.createElement("section",null,r.createElement("footer",null))))))):r.createElement("div",{className:"placeholder"},n?r.createElement("span",null,r.createElement("a",{href:G.new_product_path()},"Add a product")," to have it show up here"):"No products selected"),s?null:r.createElement("div",{role:"tooltip",id:u},"This cannot be deleted")),a.length>l?r.createElement("button",{className:"link",onClick:()=>i(l+3>a.length?a.length:l+3)},B.t("js.and_x_more_products",{count:a.length-l})):null,r.createElement(J.k,{tip:s?null:"This cannot be deleted",position:"top"},r.createElement(I.D,{color:"primary",href:G.checkout_index_url({host:t}),target:"_blank",rel:"noopener noreferrer nofollow",style:s?{}:{pointerEvents:"none"},tabIndex:s?void 0:-1},"Complete checkout")))},K=({isPreview:e})=>{const t=(0,h.wi)(),{scheme:a}=(0,x.lO)();return(0,L.v)(null!==t,"currentSeller is required"),r.createElement("a",{href:`${a}://${t.subdomain}`,target:"_blank",style:{position:"relative",display:"flex",gap:"var(--spacer-1)",alignItems:"center"},rel:"noopener noreferrer nofollow",tabIndex:e?void 0:-1},r.createElement("img",{className:"user-avatar",src:t.avatarUrl}),t.name||t.email||"")},ee=w.bP.create({name:"abandonedCartProductList",group:"block",atom:!0,selectable:!1,draggable:!1,parseHTML:()=>[{tag:"product-list-placeholder"}],renderHTML:()=>["product-list-placeholder"],addNodeView:()=>(0,E.gu)(q),addKeyboardShortcuts(){return{Backspace:()=>{const{doc:e,tr:t}=this.editor.view.state,a=this.editor.view.state.doc.lastChild;return a&&""===a.textContent&&(t.delete(t.mapping.map(e.content.size-a.nodeSize),e.content.size),this.editor.view.dispatch(t)),this.editor.chain().deleteSelection().joinBackward().selectNodeBackward().run()}}},addProseMirrorPlugins:()=>[new A.k_({filterTransaction:e=>1===(0,w.xe)(e.doc,(e=>"abandonedCartProductList"===e.type.name)).length})]}),te=e=>e.map((({external_id:e,name:t,message:a,delayed_delivery_time_duration:l,delayed_delivery_time_period:i,stream_only:n})=>({id:e,name:t,message:a,delayed_delivery_time_duration:l,delayed_delivery_time_period:i,stream_only:n}))),ae=e=>e.flatMap((e=>e.files.map((t=>({...t,email_id:e.external_id,subtitle_files:t.subtitle_files.map((e=>({...e,status:{type:"existing"}}))),status:{type:"existing"}}))))),le=e=>e.sort(((e,t)=>e.delayed_delivery_time_duration*ie(e.delayed_delivery_time_period)-t.delayed_delivery_time_duration*ie(t.delayed_delivery_time_period))),ie=e=>{switch(e){case"hour":return 3600;case"day":return 86400;case"week":return 604800;case"month":return 2592e3}},ne=()=>{var e,t;const a=(0,k.J)(),{context:l,workflow:i}=(0,c.wg)((0,u.useLoaderData)(),[5,[0,"context",[5,[0,"products_and_variant_options",[6,[9,[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"product"]]],[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"variant"]]]]]],[0,"affiliate_product_options",[6,[12,1,2,1,2,1,1]]],[0,"timezone",0],[0,"currency_symbol",0],[0,"countries",[6,0]],[0,"aws_access_key_id",0],[0,"s3_url",0],[0,"user_id",0],[0,"gumroad_address",0]]],[0,"workflow",[5,[0,"external_id",0],[0,"name",0],[0,"workflow_type",[9,[8,"product"],[8,"seller"],[8,"variant"],[8,"abandoned_cart"],[8,"audience"],[8,"affiliate"],[8,"follower"]]],[0,"workflow_trigger",[9,[8,null],[8,"member_cancellation"]]],[0,"published",2],[0,"first_published_at",[9,[8,null],0]],[0,"send_to_past_customers",2],[0,"installments",[6,[5,[0,"name",0],[0,"message",0],[0,"files",[6,[5,[0,"id",0],[0,"file_name",0],[0,"description",[9,[8,null],0]],[0,"extension",0],[0,"file_size",[9,[8,null],1]],[0,"is_pdf",2],[0,"pdf_stamp_enabled",2],[0,"is_streamable",2],[0,"stream_only",2],[0,"is_transcoding_in_progress",2],[0,"url",0],[0,"subtitle_files",[6,[5,[0,"url",0],[0,"file_name",0],[0,"extension",0],[0,"language",0],[0,"file_size",[9,[8,null],1]],[0,"signed_url",0]]]],[0,"thumbnail",[9,[8,null],[5,[0,"url",0],[0,"signed_id",0]]]]]]],[0,"published_once_already",2],[0,"member_cancellation",2],[0,"external_id",0],[0,"stream_only",2],[0,"call_to_action_text",[9,[8,null],0]],[0,"call_to_action_url",[9,[8,null],0]],[0,"new_customers_only",2],[0,"streamable",2],[0,"sent_count",[9,[8,null],1]],[0,"click_count",1],[0,"open_count",1],[0,"click_rate",[9,[8,null],1]],[0,"open_rate",[9,[8,null],1]],[0,"delayed_delivery_time_duration",1],[0,"delayed_delivery_time_period",[9,[8,"month"],[8,"hour"],[8,"week"],[8,"day"]]],[0,"displayed_delayed_delivery_time_period",0]]]],[0,"bought_products",[6,0],!0],[0,"not_bought_products",[6,0],!0],[0,"bought_variants",[6,0],!0],[0,"not_bought_variants",[6,0],!0],[0,"paid_more_than",0,!0],[0,"paid_less_than",0,!0],[0,"created_after",0,!0],[0,"created_before",0,!0],[0,"bought_from",0,!0],[0,"affiliate_products",[6,0],!0],[0,"unique_permalink",0,!0],[0,"variant_external_id",0,!0],[0,"abandoned_cart_products",[6,[5,[0,"unique_permalink",0],[0,"name",0],[0,"url",0],[0,"thumbnail_url",[9,[8,null],0]],[0,"variants",[6,[5,[0,"external_id",0],[0,"name",0]]]]]],!0],[0,"seller_has_products",2,!0]]]]),n=(0,u.useRevalidator)(),[o,M]=r.useState(i.send_to_past_customers),[m,j]=r.useState(!1),[L,N]=r.useReducer(C.Ke,ae(i.installments)),[_,w]=r.useState(te(i.installments)),A=P(i),E="abandoned_cart"===A,[p,S]=r.useState(E&&_[0]?new Set([_[0].id]):new Set),[h,x]=r.useState(new Set),O=r.useMemo((()=>({onUpload:e=>(x((t=>new Set(t).add(e))),new Promise(((t,a)=>{new D.do(e,G.rails_direct_uploads_path()).create(((l,i)=>{x((t=>{const a=new Set(t);return a.delete(e),a})),l?a(l):(0,d.Em)({method:"GET",accept:"json",url:G.s3_utility_cdn_url_for_blob_path({key:i.key})}).then((e=>e.json())).then((e=>t((0,c.wg)(e,[5,[0,"url",0]]).url))).catch((e=>{(0,d.k4)(e),a(e)}))}))}))),allowedExtensions:z.C})),[]),{evaporateUploader:Q,s3UploadConfig:Z}=(0,H.Z)({aws_access_key_id:l.aws_access_key_id,s3_url:l.s3_url,user_id:l.user_id}),W=()=>{const e=T.A.generate();w((t=>[...t,{id:e,name:"",message:"<p></p>",files:[],delayed_delivery_time_duration:0,delayed_delivery_time_period:"hour",stream_only:!1}])),S((t=>new Set(t).add(e))),J({emailId:e,fieldName:"name"})},[R,J]=r.useState(null),[V,q]=r.useState([]),[K,ee]=r.useState(null),[ie,ne]=r.useState(3),re=r.useMemo((()=>{var e,t,a;return{abandonedCartProducts:null!=(e=i.abandoned_cart_products)?e:[],shownProductCount:ie,setShownProductCount:ne,showAddProductCTA:!i.seller_has_products&&(null===i.first_published_at||0===(null!=(t=i.bought_products)?t:[]).length&&0===(null!=(a=i.bought_variants)?a:[]).length)}}),[ie]),ue=(0,b.B)((async({sendPreviewForEmailId:e,saveActionName:t="save"}={})=>{if(J(null),!(()=>{const e=new Array;return _.forEach((t=>{""===t.name.trim()&&(e.push({emailId:t.id,fieldName:"name"}),J({emailId:t.id,fieldName:"name"}),S((e=>new Set(e).add(t.id))))})),q(e),0===e.length})())return;const l={workflow:{send_to_past_customers:o,save_action_name:t,installments:_.map((t=>{const a=L.filter((e=>e.email_id===t.id));return{id:t.id,name:t.name,message:t.message,time_period:t.delayed_delivery_time_period,time_duration:t.delayed_delivery_time_duration,send_preview_email:t.id===e,files:a.map(((e,a)=>({external_id:e.id,url:e.url,position:a,stream_only:e.is_streamable&&t.stream_only,subtitle_files:e.subtitle_files})))}}))}};try{j(!0);const r=await async function(e,t){const a=await(0,d.Em)({method:"PUT",accept:"json",url:g.save_installments_internal_workflow_path(e),data:t});if(!a.ok)throw new d.o3;return(0,c.wg)(await a.json(),[9,[5,[0,"success",[8,!0]],[0,"workflow",[5,[0,"external_id",0],[0,"name",0],[0,"workflow_type",[9,[8,"product"],[8,"seller"],[8,"variant"],[8,"abandoned_cart"],[8,"audience"],[8,"affiliate"],[8,"follower"]]],[0,"workflow_trigger",[9,[8,null],[8,"member_cancellation"]]],[0,"published",2],[0,"first_published_at",[9,[8,null],0]],[0,"send_to_past_customers",2],[0,"installments",[6,[5,[0,"name",0],[0,"message",0],[0,"files",[6,[5,[0,"id",0],[0,"file_name",0],[0,"description",[9,[8,null],0]],[0,"extension",0],[0,"file_size",[9,[8,null],1]],[0,"is_pdf",2],[0,"pdf_stamp_enabled",2],[0,"is_streamable",2],[0,"stream_only",2],[0,"is_transcoding_in_progress",2],[0,"url",0],[0,"subtitle_files",[6,[5,[0,"url",0],[0,"file_name",0],[0,"extension",0],[0,"language",0],[0,"file_size",[9,[8,null],1]],[0,"signed_url",0]]]],[0,"thumbnail",[9,[8,null],[5,[0,"url",0],[0,"signed_id",0]]]]]]],[0,"published_once_already",2],[0,"member_cancellation",2],[0,"external_id",0],[0,"stream_only",2],[0,"call_to_action_text",[9,[8,null],0]],[0,"call_to_action_url",[9,[8,null],0]],[0,"new_customers_only",2],[0,"streamable",2],[0,"sent_count",[9,[8,null],1]],[0,"click_count",1],[0,"open_count",1],[0,"click_rate",[9,[8,null],1]],[0,"open_rate",[9,[8,null],1]],[0,"delayed_delivery_time_duration",1],[0,"delayed_delivery_time_period",[9,[8,"month"],[8,"hour"],[8,"week"],[8,"day"]]],[0,"displayed_delayed_delivery_time_period",0]]]],[0,"bought_products",[6,0],!0],[0,"not_bought_products",[6,0],!0],[0,"bought_variants",[6,0],!0],[0,"not_bought_variants",[6,0],!0],[0,"paid_more_than",0,!0],[0,"paid_less_than",0,!0],[0,"created_after",0,!0],[0,"created_before",0,!0],[0,"bought_from",0,!0],[0,"affiliate_products",[6,0],!0],[0,"unique_permalink",0,!0],[0,"variant_external_id",0,!0],[0,"abandoned_cart_products",[6,[5,[0,"unique_permalink",0],[0,"name",0],[0,"url",0],[0,"thumbnail_url",[9,[8,null],0]],[0,"variants",[6,[5,[0,"external_id",0],[0,"name",0]]]]]],!0],[0,"seller_has_products",2,!0]]],[0,"context",[5,[0,"products_and_variant_options",[6,[9,[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"product"]]],[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"variant"]]]]]],[0,"affiliate_product_options",[6,[12,1,3,2,1,2,1,1]]],[0,"timezone",0],[0,"currency_symbol",0],[0,"countries",[6,0]],[0,"aws_access_key_id",0],[0,"s3_url",0],[0,"user_id",0],[0,"gumroad_address",0]]],[0,"old_and_new_installment_id_mapping",[5,[1,0]]]],[5,[0,"success",[8,!1]],[0,"message",0]]])}(i.external_id,l);r.success?(a(e?"A preview has been sent to your email.":B.t("save_and_publish"===t?"js.workflow_published":"save_and_unpublish"===t?"js.unpublished_alert":"js.changes_saved"),"success"),S((e=>{const t=new Set(e);return Object.entries(r.old_and_new_installment_id_mapping).forEach((([e,a])=>{t.has(e)&&e!==a&&(t.delete(e),t.add(a))})),t})),n.revalidate(),w(te(r.workflow.installments)),N({type:"reset",files:ae(r.workflow.installments)})):a(r.message,"error")}catch(e){(0,d.k4)(e),a("Sorry, something went wrong. Please try again.","error")}finally{j(!1)}})),se=m||h.size>0||L.some((e=>(0,C._h)(e)||e.subtitle_files.some((e=>(0,C._h)(e))))),oe=le(_);return r.createElement(C.N,{value:L},r.createElement(F,{value:re},r.createElement(de,{title:i.name,navigation:r.createElement(je,{workflowExternalId:i.external_id}),actions:r.createElement(r.Fragment,null,r.createElement(s.Link,{to:"/workflows",className:"button outline",inert:se},i.published?r.createElement(r.Fragment,null,r.createElement(y.I,{name:"x-square"}),"Cancel"):r.createElement(r.Fragment,null,r.createElement(y.I,{name:"arrow-left"}),"Back")),r.createElement(I.$,{color:"primary",disabled:se,onClick:()=>ue()},"Save changes"),r.createElement(ge,{isPublished:i.published,wasPublishedPreviously:!!i.first_published_at,isDisabled:se,sendToPastCustomers:E?null:{enabled:o,toggle:M,label:me(A)},onClick:e=>ue({saveActionName:e})})),preview:oe.map((e=>r.createElement($,{key:e.id,email:e,isEditing:(null==R?void 0:R.emailId)===e.id,workflowTrigger:A,gumroadAddress:l.gumroad_address})))},r.createElement(U.l,{value:Z},r.createElement(f.dw,{value:Q},r.createElement(Y.ZU.Provider,{value:O},r.createElement(C.j2,{value:N},r.createElement("div",{className:"paragraphs"},0===_.length?r.createElement("div",{className:"placeholder"},r.createElement("h2",null,"Create emails for your workflow"),r.createElement("h4",null,"Users will receive workflows as email messages with links to any files you've attached."),r.createElement("div",null,r.createElement(I.$,{color:"primary",onClick:W},"Create email"))):r.createElement(r.Fragment,null,r.createElement("div",{className:"rows"},oe.map((e=>r.createElement(X,{key:e.id,email:e,workflowTrigger:A,expanded:p.has(e.id),focusedFieldInfo:R,invalidFieldNames:V.flatMap((t=>t.emailId===e.id?t.fieldName:[])),toggleExpanded:()=>{J(p.has(e.id)?null:{emailId:e.id,fieldName:null}),S((t=>{const a=new Set(t);return a.has(e.id)?a.delete(e.id):a.add(e.id),a}))},onFocus:t=>J({emailId:e.id,fieldName:t}),onDelete:()=>ee(e.id),onChange:t=>((e,t)=>{var a;w((a=>a.map((a=>a.id===e?{...a,...t}:a)))),J({emailId:e,fieldName:null!=(a=Object.keys(t)[0])?a:null}),void 0!==t.name&&V.some((t=>t.emailId===e))&&q((t=>t.filter((t=>!(t.emailId===e)))))})(e.id,t),onSendPreviewEmail:()=>ue({sendPreviewForEmailId:e.id}),isSaving:m,hasUploadingImages:h.size>0&&e.message.includes('src="blob:')})))),E?null:r.createElement("div",null,r.createElement(I.$,{color:"primary",onClick:W},"Add email"))),K?r.createElement(v.a,{open:!0,allowClose:!0,onClose:()=>ee(null),title:"Delete email?",footer:r.createElement(r.Fragment,null,r.createElement(I.$,{onClick:()=>ee(null)},"Cancel"),r.createElement(I.$,{color:"danger",onClick:()=>{return e=K,ee(null),w((t=>t.filter((t=>t.id!==e)))),S((t=>{const a=new Set(t);return a.delete(e),a})),void((null==R?void 0:R.emailId)===e&&J(null));var e}},"Delete"))},r.createElement("h4",null,'Are you sure you want to delete the email "',null!=(t=null==(e=_.find((({id:e})=>e===K)))?void 0:e.name)?t:"",'"? This action cannot be undone.')):null))))))))};var re=a(59727),ue=a(25902);const se=a.p+"static/caf5adc24ef28388969a.png",oe=({workflow:e,canManageWorkflow:t,onDelete:a})=>{const l=r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement("h3",{style:{marginRight:"auto"}},e.name),r.createElement("div",{style:{display:"flex",gap:"var(--spacer-4)",alignItems:"center"}},e.published?r.createElement("small",null,r.createElement(y.I,{name:"circle-fill"})," Published"):r.createElement("small",null,r.createElement(y.I,{name:"circle"})," Unpublished"),r.createElement("div",{className:"button-group"},r.createElement(s.Link,{className:"button",to:`/workflows/${e.external_id}/edit`,"aria-label":"Edit workflow",inert:!t},r.createElement(y.I,{name:"pencil"})),r.createElement(I.$,{color:"danger",outline:!0,"aria-label":"Delete workflow",disabled:!t,onClick:a},r.createElement(y.I,{name:"trash2"})))));return e.installments.length>0?r.createElement("table",{key:e.external_id},r.createElement("caption",null,l),r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{style:e.published?{width:"40%"}:void 0},"Email"),e.published?r.createElement(r.Fragment,null,r.createElement("th",null,"Delay"),r.createElement("th",null,"Sent"),r.createElement("th",null,"Opens"),r.createElement("th",null,"Clicks")):null)),r.createElement("tbody",null,e.installments.map((t=>{var a,l;return r.createElement("tr",{key:t.external_id},r.createElement("td",{"data-label":"Email"},t.name),e.published?r.createElement(r.Fragment,null,r.createElement("td",{"data-label":"Delay"},t.delayed_delivery_time_duration," ",t.displayed_delayed_delivery_time_period),r.createElement("td",{"data-label":"Sent",style:{whiteSpace:"nowrap"}},(0,re.j)({value:null!=(a=t.sent_count)?a:0})),r.createElement("td",{"data-label":"Opens",style:{whiteSpace:"nowrap"}},`${(0,re.j)({value:null!=(l=t.open_rate)?l:0})}%`),r.createElement("td",{"data-label":"Clicks",style:{whiteSpace:"nowrap"}},(0,re.j)({value:t.click_count}))):null)})))):r.createElement("section",{className:"paragraphs",key:e.external_id},l,r.createElement("div",{className:"placeholder"},r.createElement("h4",null,r.createElement(r.Fragment,null,"No emails yet,"," ",r.createElement(s.Link,{to:`/workflows/${e.external_id}/emails`,inert:!t},"add one")))))},Me=()=>{const e=(0,ue.o)(),t=(0,k.J)(),{workflows:a}=(0,c.wg)((0,u.useLoaderData)(),[5,[0,"workflows",[6,[5,[0,"external_id",0],[0,"name",0],[0,"workflow_type",[9,[8,"product"],[8,"seller"],[8,"variant"],[8,"abandoned_cart"],[8,"audience"],[8,"affiliate"],[8,"follower"]]],[0,"workflow_trigger",[9,[8,null],[8,"member_cancellation"]]],[0,"published",2],[0,"first_published_at",[9,[8,null],0]],[0,"send_to_past_customers",2],[0,"installments",[6,[5,[0,"name",0],[0,"message",0],[0,"files",[6,[5,[0,"id",0],[0,"file_name",0],[0,"description",[9,[8,null],0]],[0,"extension",0],[0,"file_size",[9,[8,null],1]],[0,"is_pdf",2],[0,"pdf_stamp_enabled",2],[0,"is_streamable",2],[0,"stream_only",2],[0,"is_transcoding_in_progress",2],[0,"url",0],[0,"subtitle_files",[6,[5,[0,"url",0],[0,"file_name",0],[0,"extension",0],[0,"language",0],[0,"file_size",[9,[8,null],1]],[0,"signed_url",0]]]],[0,"thumbnail",[9,[8,null],[5,[0,"url",0],[0,"signed_id",0]]]]]]],[0,"published_once_already",2],[0,"member_cancellation",2],[0,"external_id",0],[0,"stream_only",2],[0,"call_to_action_text",[9,[8,null],0]],[0,"call_to_action_url",[9,[8,null],0]],[0,"new_customers_only",2],[0,"streamable",2],[0,"sent_count",[9,[8,null],1]],[0,"click_count",1],[0,"open_count",1],[0,"click_rate",[9,[8,null],1]],[0,"open_rate",[9,[8,null],1]],[0,"delayed_delivery_time_duration",1],[0,"delayed_delivery_time_period",[9,[8,"month"],[8,"hour"],[8,"week"],[8,"day"]]],[0,"displayed_delayed_delivery_time_period",0]]]],[0,"bought_products",[6,0],!0],[0,"not_bought_products",[6,0],!0],[0,"bought_variants",[6,0],!0],[0,"not_bought_variants",[6,0],!0],[0,"paid_more_than",0,!0],[0,"paid_less_than",0,!0],[0,"created_after",0,!0],[0,"created_before",0,!0],[0,"bought_from",0,!0],[0,"affiliate_products",[6,0],!0],[0,"unique_permalink",0,!0],[0,"variant_external_id",0,!0],[0,"abandoned_cart_products",[6,[5,[0,"unique_permalink",0],[0,"name",0],[0,"url",0],[0,"thumbnail_url",[9,[8,null],0]],[0,"variants",[6,[5,[0,"external_id",0],[0,"name",0]]]]]],!0],[0,"seller_has_products",2,!0]]]]]),[l,i]=r.useState(a),n=!!(null==e?void 0:e.policies.workflow.create),o=r.createElement(s.Link,{to:"/workflows/new",className:"button accent",inert:!n},"New workflow"),[M,m]=r.useState(null);return r.createElement(de,{title:"Workflows",actions:o},l.length>0?r.createElement("div",{style:{display:"grid",gap:"var(--spacer-7)"}},l.map((e=>r.createElement(oe,{key:e.external_id,workflow:e,canManageWorkflow:!!n,onDelete:()=>m({id:e.external_id,name:e.name,state:"delete-confirmation"})}))),M?r.createElement(v.a,{open:!0,allowClose:"delete-confirmation"===M.state,onClose:()=>m(null),title:"Delete workflow?",footer:r.createElement(r.Fragment,null,r.createElement(I.$,{disabled:"deleting"===M.state,onClick:()=>m(null)},"Cancel"),"deleting"===M.state?r.createElement(I.$,{color:"danger",disabled:!0},"Deleting..."):r.createElement(I.$,{color:"danger",onClick:(0,b.B)((async()=>{try{m({...M,state:"deleting"}),await async function(e){const t=await(0,d.Em)({method:"DELETE",accept:"json",url:g.internal_workflow_path(e)});if(!t.ok)throw new d.o3;return(0,c.wg)(await t.json(),[5,[0,"success",2]])}(M.id),i(l.filter((e=>e.external_id!==M.id))),m(null),t("Workflow deleted!","success")}catch(e){(0,d.k4)(e),t("Sorry, something went wrong. Please try again.","error")}}))},"Delete"))},r.createElement("h4",null,'Are you sure you want to delete the workflow "',M.name,'"? This action cannot be undone.')):null):r.createElement("div",null,r.createElement("div",{className:"placeholder"},r.createElement("figure",null,r.createElement("img",{src:se})),r.createElement("h2",null,"Automate emails with ease."),r.createElement("h4",null,"Workflows allow you to send scheduled emails to a subset of your audience based on a trigger."),r.createElement("div",null,o),r.createElement("a",{href:"https://help.gumroad.com/article/131-using-workflows-to-send-automated-updates",target:"_blank",rel:"noreferrer"},"Learn more about workflows"))))};var ce=a(54912);const de=({title:e,actions:t,navigation:a,children:l,preview:i})=>{const{pathname:n}=(0,u.useLocation)(),[s,o]=r.useState(!1);return r.useEffect((()=>{var e;const t=null==(e=document.querySelector("body"))?void 0:e.classList;t&&(i?t.add("fixed-aside"):t.remove("fixed-aside")),o(!0)}),[n]),s?r.createElement(r.Fragment,null,r.createElement("header",{className:"sticky"},r.createElement("h1",null,e),t?r.createElement("div",{className:"actions"},t):null,null!=a?a:null),r.createElement("main",null,l),i?r.createElement("aside",{"aria-label":"Preview"},i):null):null},ge=({isPublished:e,wasPublishedPreviously:t,isDisabled:a,sendToPastCustomers:l,onClick:i})=>{const[n,u]=r.useState(!1);return e?r.createElement(I.$,{onClick:()=>i("save_and_unpublish"),disabled:a},"Unpublish"):t||null===l?r.createElement(I.$,{color:"accent",onClick:()=>i("save_and_publish"),disabled:a},"Publish"):r.createElement(_.A,{disabled:a,trigger:r.createElement("div",{className:"button",color:"accent"},"Publish",r.createElement(y.I,{name:"outline-cheveron-down"})),open:n,onToggle:u},r.createElement("fieldset",null,r.createElement(I.$,{color:"accent",onClick:()=>i("save_and_publish"),disabled:a},"Publish now"),r.createElement(ce.l,{value:l.enabled,onChange:l.toggle},l.label)))},me=e=>"new_subscriber"===e?"Also send to past email subscribers":"member_cancels"===e?"Also send to past members who canceled":"new_affiliate"===e?"Also send to past affiliates":"Also send to past customers",je=e=>{const{pathname:t}=(0,u.useLocation)();return r.createElement("div",{role:"tablist"},r.createElement(s.Link,{to:`/workflows/${e.workflowExternalId}/edit`,role:"tab","aria-selected":t===`/workflows/${e.workflowExternalId}/edit`},"Details"),r.createElement(s.Link,{to:`/workflows/${e.workflowExternalId}/emails`,role:"tab","aria-selected":t===`/workflows/${e.workflowExternalId}/emails`},"Emails"))},Le=()=>{const e=(0,u.useRouteError)();return r.createElement("main",null,r.createElement("div",null,r.createElement("div",{className:"placeholder"},r.createElement("p",null,(0,o.isRouteErrorResponse)(e)&&404===e.status?"The resource you're looking for doesn't exist.":"Something went wrong."))))},Ne=[{path:"/workflows",element:r.createElement(Me,null),loader:async()=>(0,o.json)(await async function(){const e=await(0,d.Em)({method:"GET",accept:"json",url:g.internal_workflows_path()});if(!e.ok)throw new d.o3;return(0,c.wg)(await e.json(),[5,[0,"workflows",[6,[5,[0,"external_id",0],[0,"name",0],[0,"workflow_type",[9,[8,"product"],[8,"seller"],[8,"variant"],[8,"abandoned_cart"],[8,"audience"],[8,"affiliate"],[8,"follower"]]],[0,"workflow_trigger",[9,[8,null],[8,"member_cancellation"]]],[0,"published",2],[0,"first_published_at",[9,[8,null],0]],[0,"send_to_past_customers",2],[0,"installments",[6,[5,[0,"name",0],[0,"message",0],[0,"files",[6,[5,[0,"id",0],[0,"file_name",0],[0,"description",[9,[8,null],0]],[0,"extension",0],[0,"file_size",[9,[8,null],1]],[0,"is_pdf",2],[0,"pdf_stamp_enabled",2],[0,"is_streamable",2],[0,"stream_only",2],[0,"is_transcoding_in_progress",2],[0,"url",0],[0,"subtitle_files",[6,[5,[0,"url",0],[0,"file_name",0],[0,"extension",0],[0,"language",0],[0,"file_size",[9,[8,null],1]],[0,"signed_url",0]]]],[0,"thumbnail",[9,[8,null],[5,[0,"url",0],[0,"signed_id",0]]]]]]],[0,"published_once_already",2],[0,"member_cancellation",2],[0,"external_id",0],[0,"stream_only",2],[0,"call_to_action_text",[9,[8,null],0]],[0,"call_to_action_url",[9,[8,null],0]],[0,"new_customers_only",2],[0,"streamable",2],[0,"sent_count",[9,[8,null],1]],[0,"click_count",1],[0,"open_count",1],[0,"click_rate",[9,[8,null],1]],[0,"open_rate",[9,[8,null],1]],[0,"delayed_delivery_time_duration",1],[0,"delayed_delivery_time_period",[9,[8,"month"],[8,"hour"],[8,"week"],[8,"day"]]],[0,"displayed_delayed_delivery_time_period",0]]]],[0,"bought_products",[6,0],!0],[0,"not_bought_products",[6,0],!0],[0,"bought_variants",[6,0],!0],[0,"not_bought_variants",[6,0],!0],[0,"paid_more_than",0,!0],[0,"paid_less_than",0,!0],[0,"created_after",0,!0],[0,"created_before",0,!0],[0,"bought_from",0,!0],[0,"affiliate_products",[6,0],!0],[0,"unique_permalink",0,!0],[0,"variant_external_id",0,!0],[0,"abandoned_cart_products",[6,[5,[0,"unique_permalink",0],[0,"name",0],[0,"url",0],[0,"thumbnail_url",[9,[8,null],0]],[0,"variants",[6,[5,[0,"external_id",0],[0,"name",0]]]]]],!0],[0,"seller_has_products",2,!0]]]]])}(),{status:200})},{path:"/workflows/new",element:r.createElement(W,null),loader:async()=>(0,o.json)(await async function(){const e=await(0,d.Em)({method:"GET",accept:"json",url:g.new_internal_workflow_path()});if(!e.ok)throw new d.o3;return(0,c.wg)(await e.json(),[5,[0,"context",[5,[0,"products_and_variant_options",[6,[9,[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"product"]]],[5,[0,"id",0],[0,"label",0],[0,"archived",2],[0,"product_permalink",0],[0,"type",[8,"variant"]]]]]],[0,"affiliate_product_options",[6,[12,1,2,1,2,1,1]]],[0,"timezone",0],[0,"currency_symbol",0],[0,"countries",[6,0]],[0,"aws_access_key_id",0],[0,"s3_url",0],[0,"user_id",0],[0,"gumroad_address",0]]]])}(),{status:200})},{path:"/workflows/:id/edit",element:r.createElement(W,null),errorElement:r.createElement(Le,null),loader:async({params:e})=>{const t=await j((0,L.i)(e.id,"Workflow ID is required"));return t.success?(0,o.json)(t):new Response("",{status:t.status})}},{path:"/workflows/:id/emails",element:r.createElement(ne,null),errorElement:r.createElement(Le,null),loader:async({params:e})=>{const t=await j((0,L.i)(e.id,"Workflow ID is required"));return t.success?(0,o.json)(t):new Response("",{status:t.status})}}],Ie=(0,N.k)({component:()=>{const e=(0,s.createBrowserRouter)(Ne);return r.createElement(s.RouterProvider,{router:e})},ssrComponent:async e=>{const{router:t,context:a}=await(0,N.Q)(e,Ne),l=()=>r.createElement(M.je,{router:t,context:a,nonce:e.csp_nonce});return l.displayName="WorkflowsRouter",l},propParser:()=>({})});n.A.initialize(),i().register({WorkflowsPage:Ie})}},e=>{e.O(0,[8281],(()=>{return t=92980,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=workflows-cda233341df5b7e4baec.js.map